<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Social Media App - Home</title>
    <style>
      body {
        margin: 0;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: #f3f4f6;
      }

      /* Navbar */
      nav {
        background: #1e293b;
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 20px;
        position: sticky;
        top: 0;
        z-index: 100;
      }
      nav .logo {
        font-size: 20px;
        font-weight: bold;
      }
      nav .user-info {
        display: flex;
        align-items: center;
        gap: 15px;
      }
      nav .user-info a {
        color: #fbbf24;
        text-decoration: none;
        font-weight: bold;
      }
      nav .user-info a:hover {
        text-decoration: underline;
      }

      /* Container */
      .container {
        display: flex;
        max-width: 1200px;
        margin: 20px auto;
        gap: 20px;
      }

      /* Feed */
      .feed {
        flex: 2;
      }

      .post {
        background: white;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 20px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }

      .post-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .user-info-box {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .user-info-box img {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        object-fit: cover;
      }

      .username {
        font-weight: bold;
        color: #111827;
      }

      .follow-btn {
        padding: 6px 14px;
        border-radius: 20px;
        border: none;
        cursor: pointer;
        background: #2563eb;
        color: white;
        font-weight: bold;
        transition: 0.3s;
      }

      .follow-btn.following {
        background: #10b981;
      }

      .post img {
        width: 100%;
        border-radius: 10px;
        margin: 12px 0;
      }

      .actions {
        display: flex;
        gap: 20px;
        margin-top: 8px;
      }

      .actions button {
        border: none;
        background: none;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        color: #374151;
      }

      .actions button.liked {
        color: #ef4444;
      }

      /* Comments */
      .comments {
        margin-top: 10px;
      }

      .comment {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #f9fafb;
        padding: 6px 10px;
        border-radius: 6px;
        margin-bottom: 6px;
      }

      .comment .delete {
        cursor: pointer;
        color: #ef4444;
        font-weight: bold;
      }

      .add-comment {
        display: flex;
        margin-top: 10px;
      }

      .add-comment input {
        flex: 1;
        padding: 8px;
        border-radius: 6px;
        border: 1px solid #d1d5db;
        outline: none;
      }

      .add-comment button {
        padding: 8px 12px;
        margin-left: 5px;
        background: #2563eb;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
      }

      /* Sidebar */
      .sidebar {
        flex: 1;
        background: white;
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        text-align: center;
      }

      .sidebar img {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        object-fit: cover;
      }

      .sidebar h3 {
        margin: 10px 0;
      }

      .sidebar button {
        padding: 8px 15px;
        background: #2563eb;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
      }

      /* Suggested Users */
      .suggested {
        margin-top: 20px;
        text-align: left;
      }

      .suggested h4 {
        margin-bottom: 10px;
        font-size: 16px;
        color: #374151;
      }

      .suggested-user {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 12px;
      }

      .suggested-user .info {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .suggested-user img {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
      }

      .suggested-user span {
        font-weight: 500;
      }

      .suggested-user button {
        padding: 5px 12px;
        border-radius: 20px;
        border: none;
        background: #2563eb;
        color: white;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
      }

      .suggested-user button.following {
        background: #10b981;
      }

      .button {
        display: inline-block;
        padding: 10px 20px;
        background-color: #2563eb; /* Blue */
        color: #fff;
        font-size: 16px;
        font-weight: 500;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
      }

      .button:hover {
        background-color: #1d4ed8; /* Darker blue */
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
      }

      .button:active {
        transform: translateY(0);
        box-shadow: 0 2px 6px rgba(37, 99, 235, 0.2);
      }
      .username {
        font-weight: bold;
        font-size: 16px;
        color: #262626;
        text-decoration: none;
        cursor: pointer;
      }

      .username:hover {
        color: #3897f0; /* Instagram blue on hover */
      }
    </style>
  </head>
  <body>
<button onclick="toggleFollow(this)">Follow</button> ```

**Fix:** Add `data-username="alex_09"` to the button.

## Fixed HTML/JavaScript File

Here is the corrected and clean file. I have fixed the syntax error and added the missing `data-username` attribute.

```html
<!DOCTYPE html>
<html>
  <body>
    <nav>
      <div class="logo">üåê Social Media App</div>
      <div class="user-info">
        <span id="username-display">rafay</span> /
        <a href="#" onclick="logout()">Logout</a>
      </div>
    </nav>

    <div class="container">
      <div class="feed">
        <div class="post">
          <div class="post-header">
            <div class="user-info-box">
              <img src="https://i.pravatar.cc/50?img=12" alt="Profile" />
              <a href="{% url 'another' %}" class="username">tomi_12</a>
            </div>
            <button class="follow-btn" onclick="toggleFollow(this)" data-username="tomi_12">Follow</button>
          </div>
          <img
            src="https://fastly.picsum.photos/id/916/600/300.jpg?hmac=4RbGYLa0PYDL6lFm5GLxhIFU5jVZhqF5ptTg1onsPIU"
            alt="Random Post"
          />

          <div class="actions">
            <button onclick="toggleLike(this)">
              ‚ù§Ô∏è Like (<span class="like-count">0</span>)
            </button>
            <button onclick="focusComment(this)">üí¨ Comment</button>
          </div>

          <div class="comments"></div>

          <div class="add-comment">
            <input type="text" placeholder="Add a comment..." />
            <button onclick="addComment(this)">Post</button>
          </div>
        </div>
      </div>

      <div class="sidebar">
        <img src="https://i.pravatar.cc/100?img=5" alt="Profile" />
        <h3>My Profile</h3>
        <a href="{% url 'profile' %}" class="button">Profile</a>

        <div class="suggested">
          <h4>Suggested</h4>

          <div class="suggested-user">
            <div class="info">
              <img src="https://i.pravatar.cc/40?img=32" alt="User">
              <span>rmdim</span>
            </div>
            <button onclick="toggleFollow(this)" data-username="rmdim">Follow</button>
          </div>

          <div class="suggested-user">
            <div class="info">
              <img src="https://i.pravatar.cc/40?img=47" alt="User" />
              <span>alex_09</span>
            </div>
            <button onclick="toggleFollow(this)" data-username="alex_09">Follow</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Get a CSRF token from the cookie for POST requests
      function getCookie(name) {
          let cookieValue = null;
          if (document.cookie && document.cookie !== '') {
              const cookies = document.cookie.split(';');
              for (let i = 0; i < cookies.length; i++) {
                  const cookie = cookies[i].trim();
                  // Does this cookie string begin with the name we want?
                  if (cookie.startsWith(name + '=')) {
                      cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                      break;
                  }
              }
          }
          return cookieValue;
      }
      const csrftoken = getCookie('csrftoken'); // <-- Define the token globally

      // Follow Button (Now communicates with Django backend)
      function toggleFollow(btn) {
          const targetUsername = btn.getAttribute('data-username');
          // The safety check prevents fetch from running if data-username is missing
          if (!targetUsername) {
            console.error('Error: Follow button is missing data-username attribute.');
            alert('Follow failed: Missing username info.');
            return; 
          }

          fetch('{% url "toggle_follow" %}', { // Use Django's url tag
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
                  'X-CSRFToken': csrftoken // Required for POST requests in Django
              },
              body: JSON.stringify({ 'username': targetUsername })
          })
          .then(response => {
              if (response.status === 403) {
                  // Handle CSRF failure specifically
                  throw new Error('403 Forbidden: CSRF token issue or not logged in.');
              }
              if (!response.ok) {
                  // Handle other HTTP errors (e.g., 500 from server)
                  throw new Error(`HTTP error! status: ${response.status}`);
              }
              return response.json();
          })
          .then(data => {
              if (data.status === 'success') {
                  // Update the button text based on the response from the server
                  if (data.is_following) {
                      btn.classList.add("following");
                      btn.textContent = "Following";
                  } else {
                      btn.classList.remove("following");
                      btn.textContent = "Follow";
                  }
                  console.log(data.message);
              } else {
                  alert(data.message); // e.g., "Cannot follow yourself"
              }
          })
          .catch(error => {
              // Log the specific error and show a generic message to the user
              console.error('Fetch Error:', error);
              alert('An error occurred. Check the console for details.');
          });
      }

      // Like Button (only one like per user)
      function toggleLike(btn) {
        let countEl = btn.querySelector(".like-count");
        let count = parseInt(countEl.textContent);
        if (btn.classList.contains("liked")) {
          btn.classList.remove("liked");
          countEl.textContent = count - 1;
        } else {
          btn.classList.add("liked");
          countEl.textContent = count + 1;
        }
      }

      // Add Comment
      function addComment(btn) {
        let input = btn.previousElementSibling;
        let commentText = input.value.trim();
        if (!commentText) return;
        let commentsDiv = btn.closest(".post").querySelector(".comments");

        let commentEl = document.createElement("div");
        commentEl.className = "comment";
        commentEl.innerHTML = `<span><b>rafay:</b> ${commentText}</span>
                               <span class="delete" onclick="deleteComment(this)">‚úñ</span>`;
        commentsDiv.appendChild(commentEl);
        input.value = "";
      }

      // Delete Comment
      function deleteComment(el) {
        el.parentElement.remove();
      }

      // Focus comment box
      function focusComment(btn) {
        let input = btn.closest(".post").querySelector(".add-comment input");
        input.focus();
      }
      
      // Logout
      function logout() {
        document.getElementById("username-display").textContent = "Guest";
        alert("You have logged out!");
      }
    </script>
  </body>
</html>